var margin={top:20,right:10,bottom:20,left:10},formatNumber=d3.format(",d"),transitioning,el=document.getElementsByClassName("jumbotron")[0],width=.7*el.offsetWidth,height=el.offsetHeight/2,x=d3.scale.linear().domain([0,width]).range([0,width]),y=d3.scale.linear().domain([0,height]).range([0,height]),treemap=d3.layout.treemap().children(function(a,b){return b?null:a._children}).sort(function(a,b){return a.value-b.value}).ratio(height/width*.5*(1+Math.sqrt(5))).round(!1),svg=d3.select("#chart").append("svg").attr("width",width+margin.left+margin.right).attr("height",height+margin.bottom+margin.top).style("margin-left",-margin.left+"px").style("margin.right",-margin.right+"px").style("margin-top",-margin.top+"px").style("margin.bottom",-margin.bottom+"px").append("g").attr("transform","translate("+margin.left+","+margin.top+")").style("shape-rendering","crispEdges"),grandparent=svg.append("g").attr("class","grandparent");grandparent.append("rect").attr("y",-margin.top).attr("width",width).attr("height",margin.top),grandparent.append("text").attr("x",6).attr("y",6-margin.top).attr("dy",".75em"),d3.json("skills.json",function(a){function b(a){a.x=a.y=0,a.dx=width,a.dy=height,a.depth=0}function c(a){return(a._children=a.children)?a.value=a.children.reduce(function(a,b){return a+c(b)},0):a.value}function d(a){a._children&&(treemap.nodes({_children:a._children}),a._children.forEach(function(b){b.x=a.x+b.x*a.dx,b.y=a.y+b.y*a.dy,b.dx*=a.dx,b.dy*=a.dy,b.parent=a,d(b)}))}function e(a){function b(a){if(!transitioning&&a){transitioning=!0;var b=e(a),d=c.transition().duration(750),h=b.transition().duration(750);x.domain([a.x,a.x+a.dx]),y.domain([a.y,a.y+a.dy]),svg.style("shape-rendering",null),svg.selectAll(".depth").sort(function(a,b){return a.depth-b.depth}),b.selectAll("text").style("fill-opacity",0),d.selectAll("text").call(f).style("fill-opacity",0),h.selectAll("text").call(f).style("fill-opacity",1),d.selectAll("rect").call(g),h.selectAll("rect").call(g),d.remove().each("end",function(){svg.style("shape-rendering","crispEdges"),transitioning=!1})}}grandparent.datum(a.parent).on("click",b).select("text").text(h(a));var c=svg.insert("g",".grandparent").datum(a).attr("class","depth"),d=c.selectAll("g").data(a._children).enter().append("g");return d.filter(function(a){return a._children}).classed("children",!0).on("click",b),d.selectAll(".child").data(function(a){return a._children||[a]}).enter().append("rect").attr("class","child").call(g),d.append("rect").attr("class","parent").attr("class",function(a){return a.name.replace(/[\W]/g,"")}).call(g).append("title").text(function(a){return formatNumber(a.value)}),d.append("text").attr("dy",".75em").text(function(a){return a.name}).call(f),d}function f(a){a.attr("x",function(a){return x(a.x)+6}).attr("y",function(a){return y(a.y)+6})}function g(a){a.attr("x",function(a){return x(a.x)}).attr("y",function(a){return y(a.y)}).attr("width",function(a){return x(a.x+a.dx)-x(a.x)}).attr("height",function(a){return y(a.y+a.dy)-y(a.y)})}function h(a){return a.parent?h(a.parent)+"."+a.name:a.name}b(a),c(a),d(a),e(a)}),$(function(){$("a.page-scroll").bind("click",function(a){var b=$(this);$("html, body").stop().animate({scrollTop:$(b.attr("href")).offset().top-50},1500,"easeInOutExpo"),a.preventDefault()})}),$(function(){$('[data-toggle="popover"]').popover()});